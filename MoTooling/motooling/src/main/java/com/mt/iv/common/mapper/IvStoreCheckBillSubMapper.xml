<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.mt.iv.common.dao.IvStoreCheckBillSubMapper" >
  <resultMap id="BaseResultMap" type="com.mt.iv.common.model.IvStoreCheckBillSub" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Tue Nov 28 13:57:29 CST 2017.
    -->
    <id column="id" property="id" jdbcType="BIGINT" />
    <result column="check_bill_id" property="checkBillId" jdbcType="INTEGER" />
    <result column="store_room_id" property="storeRoomId" jdbcType="INTEGER" />
    <result column="store_room_name" property="storeRoomName" jdbcType="VARCHAR" />
    <result column="mat_id" property="matId" jdbcType="BIGINT" />
    <result column="mat_no" property="matNo" jdbcType="VARCHAR" />
    <result column="mat_desc" property="matDesc" jdbcType="VARCHAR" />
    <result column="mat_type_id" property="matTypeId" jdbcType="BIGINT" />
    <result column="mat_type_name" property="matTypeName" jdbcType="VARCHAR" />
    <result column="mat_model" property="matModel" jdbcType="VARCHAR" />
    <result column="unit" property="unit" jdbcType="VARCHAR" />
    <result column="last_qty" property="lastQty" jdbcType="DECIMAL" />
    <result column="last_price" property="lastPrice" jdbcType="DECIMAL" />
    <result column="occur_in_qty" property="occurInQty" jdbcType="DECIMAL" />
    <result column="occur_in_price" property="occurInPrice" jdbcType="DECIMAL" />
    <result column="occur_out_qty" property="occurOutQty" jdbcType="DECIMAL" />
    <result column="occur_out_price" property="occurOutPrice" jdbcType="DECIMAL" />
    <result column="occur_spoil_qty" property="occurSpoilQty" jdbcType="DECIMAL" />
    <result column="occur_spoil_price" property="occurSpoilPrice" jdbcType="DECIMAL" />
    <result column="check_bill_qty" property="checkBillQty" jdbcType="DECIMAL" />
    <result column="check_bill_price" property="checkBillPrice" jdbcType="DECIMAL" />
    <result column="check_store_qty" property="checkStoreQty" jdbcType="DECIMAL" />
    <result column="check_store_price" property="checkStorePrice" jdbcType="DECIMAL" />
    <result column="check_real_qty" property="checkRealQty" jdbcType="DECIMAL" />
    <result column="check_real_price" property="checkRealPrice" jdbcType="DECIMAL" />
    <result column="check_differ_ratio" property="checkDifferRatio" jdbcType="DECIMAL" />
    <result column="check_profit_loss_qty" property="checkProfitLossQty" jdbcType="DECIMAL" />
    <result column="check_profit_loss_price" property="checkProfitLossPrice" jdbcType="DECIMAL" />
    <result column="check_profit_loss_reason" property="checkProfitLossReason" jdbcType="VARCHAR" />
    <result column="is_with_voucher" property="isWithVoucher" jdbcType="BIT" />
    <result column="is_dealed_with_voucher" property="isDealedWithVoucher" jdbcType="BIT" />
    <result column="is_manual_changed" property="isManualChanged" jdbcType="BIT" />
    <result column="liquidate_flag" property="liquidateFlag" jdbcType="CHAR" />
    <result column="created_at" property="createdAt" jdbcType="TIMESTAMP" />
    <result column="updated_at" property="updatedAt" jdbcType="TIMESTAMP" />
    <result column="status" property="status" jdbcType="TINYINT" />
  </resultMap>
  <sql id="Base_Column_List" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Tue Nov 28 13:57:29 CST 2017.
    -->
    id, check_bill_id, store_room_id, store_room_name, mat_id, mat_no, mat_desc, mat_type_id, 
    mat_type_name, mat_model, unit, last_qty, last_price, occur_in_qty, occur_in_price, 
    occur_out_qty, occur_out_price, occur_spoil_qty, occur_spoil_price, check_bill_qty, 
    check_bill_price, check_store_qty, check_store_price, check_real_qty, check_real_price, 
    check_differ_ratio, check_profit_loss_qty, check_profit_loss_price, check_profit_loss_reason, 
    is_with_voucher, is_dealed_with_voucher, is_manual_changed, liquidate_flag, created_at, 
    updated_at, status
  </sql>
  <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.Long" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Tue Nov 28 13:57:29 CST 2017.
    -->
    select 
    <include refid="Base_Column_List" />
    from iv_store_check_bill_sub
    where id = #{id,jdbcType=BIGINT}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Long" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Tue Nov 28 13:57:29 CST 2017.
    -->
    delete from iv_store_check_bill_sub
    where id = #{id,jdbcType=BIGINT}
  </delete>
  <insert id="insert" parameterType="com.mt.iv.common.model.IvStoreCheckBillSub" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Tue Nov 28 13:57:29 CST 2017.
    -->
    insert into iv_store_check_bill_sub (id, check_bill_id, store_room_id, 
      store_room_name, mat_id, mat_no, 
      mat_desc, mat_type_id, mat_type_name, 
      mat_model, unit, last_qty, 
      last_price, occur_in_qty, occur_in_price, 
      occur_out_qty, occur_out_price, occur_spoil_qty, 
      occur_spoil_price, check_bill_qty, check_bill_price, 
      check_store_qty, check_store_price, check_real_qty, 
      check_real_price, check_differ_ratio, check_profit_loss_qty, 
      check_profit_loss_price, check_profit_loss_reason, 
      is_with_voucher, is_dealed_with_voucher, is_manual_changed, 
      liquidate_flag, created_at, updated_at, 
      status)
    values (#{id,jdbcType=BIGINT}, #{checkBillId,jdbcType=INTEGER}, #{storeRoomId,jdbcType=INTEGER}, 
      #{storeRoomName,jdbcType=VARCHAR}, #{matId,jdbcType=BIGINT}, #{matNo,jdbcType=VARCHAR}, 
      #{matDesc,jdbcType=VARCHAR}, #{matTypeId,jdbcType=BIGINT}, #{matTypeName,jdbcType=VARCHAR}, 
      #{matModel,jdbcType=VARCHAR}, #{unit,jdbcType=VARCHAR}, #{lastQty,jdbcType=DECIMAL}, 
      #{lastPrice,jdbcType=DECIMAL}, #{occurInQty,jdbcType=DECIMAL}, #{occurInPrice,jdbcType=DECIMAL}, 
      #{occurOutQty,jdbcType=DECIMAL}, #{occurOutPrice,jdbcType=DECIMAL}, #{occurSpoilQty,jdbcType=DECIMAL}, 
      #{occurSpoilPrice,jdbcType=DECIMAL}, #{checkBillQty,jdbcType=DECIMAL}, #{checkBillPrice,jdbcType=DECIMAL}, 
      #{checkStoreQty,jdbcType=DECIMAL}, #{checkStorePrice,jdbcType=DECIMAL}, #{checkRealQty,jdbcType=DECIMAL}, 
      #{checkRealPrice,jdbcType=DECIMAL}, #{checkDifferRatio,jdbcType=DECIMAL}, #{checkProfitLossQty,jdbcType=DECIMAL}, 
      #{checkProfitLossPrice,jdbcType=DECIMAL}, #{checkProfitLossReason,jdbcType=VARCHAR}, 
      #{isWithVoucher,jdbcType=BIT}, #{isDealedWithVoucher,jdbcType=BIT}, #{isManualChanged,jdbcType=BIT}, 
      #{liquidateFlag,jdbcType=CHAR}, #{createdAt,jdbcType=TIMESTAMP}, #{updatedAt,jdbcType=TIMESTAMP}, 
      #{status,jdbcType=TINYINT})
  </insert>
  <insert id="insertSelective" parameterType="com.mt.iv.common.model.IvStoreCheckBillSub" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Tue Nov 28 13:57:29 CST 2017.
    -->
    insert into iv_store_check_bill_sub
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="id != null" >
        id,
      </if>
      <if test="checkBillId != null" >
        check_bill_id,
      </if>
      <if test="storeRoomId != null" >
        store_room_id,
      </if>
      <if test="storeRoomName != null" >
        store_room_name,
      </if>
      <if test="matId != null" >
        mat_id,
      </if>
      <if test="matNo != null" >
        mat_no,
      </if>
      <if test="matDesc != null" >
        mat_desc,
      </if>
      <if test="matTypeId != null" >
        mat_type_id,
      </if>
      <if test="matTypeName != null" >
        mat_type_name,
      </if>
      <if test="matModel != null" >
        mat_model,
      </if>
      <if test="unit != null" >
        unit,
      </if>
      <if test="lastQty != null" >
        last_qty,
      </if>
      <if test="lastPrice != null" >
        last_price,
      </if>
      <if test="occurInQty != null" >
        occur_in_qty,
      </if>
      <if test="occurInPrice != null" >
        occur_in_price,
      </if>
      <if test="occurOutQty != null" >
        occur_out_qty,
      </if>
      <if test="occurOutPrice != null" >
        occur_out_price,
      </if>
      <if test="occurSpoilQty != null" >
        occur_spoil_qty,
      </if>
      <if test="occurSpoilPrice != null" >
        occur_spoil_price,
      </if>
      <if test="checkBillQty != null" >
        check_bill_qty,
      </if>
      <if test="checkBillPrice != null" >
        check_bill_price,
      </if>
      <if test="checkStoreQty != null" >
        check_store_qty,
      </if>
      <if test="checkStorePrice != null" >
        check_store_price,
      </if>
      <if test="checkRealQty != null" >
        check_real_qty,
      </if>
      <if test="checkRealPrice != null" >
        check_real_price,
      </if>
      <if test="checkDifferRatio != null" >
        check_differ_ratio,
      </if>
      <if test="checkProfitLossQty != null" >
        check_profit_loss_qty,
      </if>
      <if test="checkProfitLossPrice != null" >
        check_profit_loss_price,
      </if>
      <if test="checkProfitLossReason != null" >
        check_profit_loss_reason,
      </if>
      <if test="isWithVoucher != null" >
        is_with_voucher,
      </if>
      <if test="isDealedWithVoucher != null" >
        is_dealed_with_voucher,
      </if>
      <if test="isManualChanged != null" >
        is_manual_changed,
      </if>
      <if test="liquidateFlag != null" >
        liquidate_flag,
      </if>
      <if test="createdAt != null" >
        created_at,
      </if>
      <if test="updatedAt != null" >
        updated_at,
      </if>
      <if test="status != null" >
        status,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <if test="id != null" >
        #{id,jdbcType=BIGINT},
      </if>
      <if test="checkBillId != null" >
        #{checkBillId,jdbcType=INTEGER},
      </if>
      <if test="storeRoomId != null" >
        #{storeRoomId,jdbcType=INTEGER},
      </if>
      <if test="storeRoomName != null" >
        #{storeRoomName,jdbcType=VARCHAR},
      </if>
      <if test="matId != null" >
        #{matId,jdbcType=BIGINT},
      </if>
      <if test="matNo != null" >
        #{matNo,jdbcType=VARCHAR},
      </if>
      <if test="matDesc != null" >
        #{matDesc,jdbcType=VARCHAR},
      </if>
      <if test="matTypeId != null" >
        #{matTypeId,jdbcType=BIGINT},
      </if>
      <if test="matTypeName != null" >
        #{matTypeName,jdbcType=VARCHAR},
      </if>
      <if test="matModel != null" >
        #{matModel,jdbcType=VARCHAR},
      </if>
      <if test="unit != null" >
        #{unit,jdbcType=VARCHAR},
      </if>
      <if test="lastQty != null" >
        #{lastQty,jdbcType=DECIMAL},
      </if>
      <if test="lastPrice != null" >
        #{lastPrice,jdbcType=DECIMAL},
      </if>
      <if test="occurInQty != null" >
        #{occurInQty,jdbcType=DECIMAL},
      </if>
      <if test="occurInPrice != null" >
        #{occurInPrice,jdbcType=DECIMAL},
      </if>
      <if test="occurOutQty != null" >
        #{occurOutQty,jdbcType=DECIMAL},
      </if>
      <if test="occurOutPrice != null" >
        #{occurOutPrice,jdbcType=DECIMAL},
      </if>
      <if test="occurSpoilQty != null" >
        #{occurSpoilQty,jdbcType=DECIMAL},
      </if>
      <if test="occurSpoilPrice != null" >
        #{occurSpoilPrice,jdbcType=DECIMAL},
      </if>
      <if test="checkBillQty != null" >
        #{checkBillQty,jdbcType=DECIMAL},
      </if>
      <if test="checkBillPrice != null" >
        #{checkBillPrice,jdbcType=DECIMAL},
      </if>
      <if test="checkStoreQty != null" >
        #{checkStoreQty,jdbcType=DECIMAL},
      </if>
      <if test="checkStorePrice != null" >
        #{checkStorePrice,jdbcType=DECIMAL},
      </if>
      <if test="checkRealQty != null" >
        #{checkRealQty,jdbcType=DECIMAL},
      </if>
      <if test="checkRealPrice != null" >
        #{checkRealPrice,jdbcType=DECIMAL},
      </if>
      <if test="checkDifferRatio != null" >
        #{checkDifferRatio,jdbcType=DECIMAL},
      </if>
      <if test="checkProfitLossQty != null" >
        #{checkProfitLossQty,jdbcType=DECIMAL},
      </if>
      <if test="checkProfitLossPrice != null" >
        #{checkProfitLossPrice,jdbcType=DECIMAL},
      </if>
      <if test="checkProfitLossReason != null" >
        #{checkProfitLossReason,jdbcType=VARCHAR},
      </if>
      <if test="isWithVoucher != null" >
        #{isWithVoucher,jdbcType=BIT},
      </if>
      <if test="isDealedWithVoucher != null" >
        #{isDealedWithVoucher,jdbcType=BIT},
      </if>
      <if test="isManualChanged != null" >
        #{isManualChanged,jdbcType=BIT},
      </if>
      <if test="liquidateFlag != null" >
        #{liquidateFlag,jdbcType=CHAR},
      </if>
      <if test="createdAt != null" >
        #{createdAt,jdbcType=TIMESTAMP},
      </if>
      <if test="updatedAt != null" >
        #{updatedAt,jdbcType=TIMESTAMP},
      </if>
      <if test="status != null" >
        #{status,jdbcType=TINYINT},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.mt.iv.common.model.IvStoreCheckBillSub" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Tue Nov 28 13:57:29 CST 2017.
    -->
    update iv_store_check_bill_sub
    <set >
      <if test="checkBillId != null" >
        check_bill_id = #{checkBillId,jdbcType=INTEGER},
      </if>
      <if test="storeRoomId != null" >
        store_room_id = #{storeRoomId,jdbcType=INTEGER},
      </if>
      <if test="storeRoomName != null" >
        store_room_name = #{storeRoomName,jdbcType=VARCHAR},
      </if>
      <if test="matId != null" >
        mat_id = #{matId,jdbcType=BIGINT},
      </if>
      <if test="matNo != null" >
        mat_no = #{matNo,jdbcType=VARCHAR},
      </if>
      <if test="matDesc != null" >
        mat_desc = #{matDesc,jdbcType=VARCHAR},
      </if>
      <if test="matTypeId != null" >
        mat_type_id = #{matTypeId,jdbcType=BIGINT},
      </if>
      <if test="matTypeName != null" >
        mat_type_name = #{matTypeName,jdbcType=VARCHAR},
      </if>
      <if test="matModel != null" >
        mat_model = #{matModel,jdbcType=VARCHAR},
      </if>
      <if test="unit != null" >
        unit = #{unit,jdbcType=VARCHAR},
      </if>
      <if test="lastQty != null" >
        last_qty = #{lastQty,jdbcType=DECIMAL},
      </if>
      <if test="lastPrice != null" >
        last_price = #{lastPrice,jdbcType=DECIMAL},
      </if>
      <if test="occurInQty != null" >
        occur_in_qty = #{occurInQty,jdbcType=DECIMAL},
      </if>
      <if test="occurInPrice != null" >
        occur_in_price = #{occurInPrice,jdbcType=DECIMAL},
      </if>
      <if test="occurOutQty != null" >
        occur_out_qty = #{occurOutQty,jdbcType=DECIMAL},
      </if>
      <if test="occurOutPrice != null" >
        occur_out_price = #{occurOutPrice,jdbcType=DECIMAL},
      </if>
      <if test="occurSpoilQty != null" >
        occur_spoil_qty = #{occurSpoilQty,jdbcType=DECIMAL},
      </if>
      <if test="occurSpoilPrice != null" >
        occur_spoil_price = #{occurSpoilPrice,jdbcType=DECIMAL},
      </if>
      <if test="checkBillQty != null" >
        check_bill_qty = #{checkBillQty,jdbcType=DECIMAL},
      </if>
      <if test="checkBillPrice != null" >
        check_bill_price = #{checkBillPrice,jdbcType=DECIMAL},
      </if>
      <if test="checkStoreQty != null" >
        check_store_qty = #{checkStoreQty,jdbcType=DECIMAL},
      </if>
      <if test="checkStorePrice != null" >
        check_store_price = #{checkStorePrice,jdbcType=DECIMAL},
      </if>
      <if test="checkRealQty != null" >
        check_real_qty = #{checkRealQty,jdbcType=DECIMAL},
      </if>
      <if test="checkRealPrice != null" >
        check_real_price = #{checkRealPrice,jdbcType=DECIMAL},
      </if>
      <if test="checkDifferRatio != null" >
        check_differ_ratio = #{checkDifferRatio,jdbcType=DECIMAL},
      </if>
      <if test="checkProfitLossQty != null" >
        check_profit_loss_qty = #{checkProfitLossQty,jdbcType=DECIMAL},
      </if>
      <if test="checkProfitLossPrice != null" >
        check_profit_loss_price = #{checkProfitLossPrice,jdbcType=DECIMAL},
      </if>
      <if test="checkProfitLossReason != null" >
        check_profit_loss_reason = #{checkProfitLossReason,jdbcType=VARCHAR},
      </if>
      <if test="isWithVoucher != null" >
        is_with_voucher = #{isWithVoucher,jdbcType=BIT},
      </if>
      <if test="isDealedWithVoucher != null" >
        is_dealed_with_voucher = #{isDealedWithVoucher,jdbcType=BIT},
      </if>
      <if test="isManualChanged != null" >
        is_manual_changed = #{isManualChanged,jdbcType=BIT},
      </if>
      <if test="liquidateFlag != null" >
        liquidate_flag = #{liquidateFlag,jdbcType=CHAR},
      </if>
      <if test="createdAt != null" >
        created_at = #{createdAt,jdbcType=TIMESTAMP},
      </if>
      <if test="updatedAt != null" >
        updated_at = #{updatedAt,jdbcType=TIMESTAMP},
      </if>
      <if test="status != null" >
        status = #{status,jdbcType=TINYINT},
      </if>
    </set>
    where id = #{id,jdbcType=BIGINT}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.mt.iv.common.model.IvStoreCheckBillSub" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Tue Nov 28 13:57:29 CST 2017.
    -->
    update iv_store_check_bill_sub
    set check_bill_id = #{checkBillId,jdbcType=INTEGER},
      store_room_id = #{storeRoomId,jdbcType=INTEGER},
      store_room_name = #{storeRoomName,jdbcType=VARCHAR},
      mat_id = #{matId,jdbcType=BIGINT},
      mat_no = #{matNo,jdbcType=VARCHAR},
      mat_desc = #{matDesc,jdbcType=VARCHAR},
      mat_type_id = #{matTypeId,jdbcType=BIGINT},
      mat_type_name = #{matTypeName,jdbcType=VARCHAR},
      mat_model = #{matModel,jdbcType=VARCHAR},
      unit = #{unit,jdbcType=VARCHAR},
      last_qty = #{lastQty,jdbcType=DECIMAL},
      last_price = #{lastPrice,jdbcType=DECIMAL},
      occur_in_qty = #{occurInQty,jdbcType=DECIMAL},
      occur_in_price = #{occurInPrice,jdbcType=DECIMAL},
      occur_out_qty = #{occurOutQty,jdbcType=DECIMAL},
      occur_out_price = #{occurOutPrice,jdbcType=DECIMAL},
      occur_spoil_qty = #{occurSpoilQty,jdbcType=DECIMAL},
      occur_spoil_price = #{occurSpoilPrice,jdbcType=DECIMAL},
      check_bill_qty = #{checkBillQty,jdbcType=DECIMAL},
      check_bill_price = #{checkBillPrice,jdbcType=DECIMAL},
      check_store_qty = #{checkStoreQty,jdbcType=DECIMAL},
      check_store_price = #{checkStorePrice,jdbcType=DECIMAL},
      check_real_qty = #{checkRealQty,jdbcType=DECIMAL},
      check_real_price = #{checkRealPrice,jdbcType=DECIMAL},
      check_differ_ratio = #{checkDifferRatio,jdbcType=DECIMAL},
      check_profit_loss_qty = #{checkProfitLossQty,jdbcType=DECIMAL},
      check_profit_loss_price = #{checkProfitLossPrice,jdbcType=DECIMAL},
      check_profit_loss_reason = #{checkProfitLossReason,jdbcType=VARCHAR},
      is_with_voucher = #{isWithVoucher,jdbcType=BIT},
      is_dealed_with_voucher = #{isDealedWithVoucher,jdbcType=BIT},
      is_manual_changed = #{isManualChanged,jdbcType=BIT},
      liquidate_flag = #{liquidateFlag,jdbcType=CHAR},
      created_at = #{createdAt,jdbcType=TIMESTAMP},
      updated_at = #{updatedAt,jdbcType=TIMESTAMP},
      status = #{status,jdbcType=TINYINT}
    where id = #{id,jdbcType=BIGINT}
  </update>


  <!-- wendy添加-->

  <insert id="addStoreCheckBillSubDetail" parameterType="Map" useGeneratedKeys="true" keyProperty="id" keyColumn="id">
  <selectKey resultType="int" order="AFTER" keyProperty="id">
    SELECT LAST_INSERT_ID() as id
  </selectKey>
    insert into iv_store_check_bill_sub
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="id != null  and id !=''" >
        check_bill_id,
      </if>
      <if test="store_room_id != null and store_room_id !=''" >
        store_room_id,
      </if>
      <if test="store_room_name != null and store_room_name !=''" >
        store_room_name,
      </if>
      <if test="mat_id != null and mat_id !=''" >
        mat_id,
      </if>
      <if test="mat_no != null and mat_no !=''" >
        mat_no,
      </if>
      <if test="mat_desc != null and mat_desc !=''" >
        mat_desc,
      </if>
      <if test="mat_type_id != null and mat_type_id !=''" >
        mat_type_id,
      </if>
      <if test="mat_type_name != null and mat_type_name !=''" >
        mat_type_name,
      </if>
      <if test="mat_model != null and mat_model !=''" >
        mat_model,
      </if>
      <if test="unit != null and unit !=''" >
        unit,
      </if>
      <if test="last_qty != null and last_qty !=''" >
        last_qty,
      </if>
      <if test="last_price != null and last_price !=''" >
        last_price,
      </if>
      <if test="occur_in_qty != null and occur_in_qty !=''" >
        occur_in_qty,
      </if>
      <if test="occur_in_price != null and occur_in_price !=''" >
        occur_in_price,
      </if>
      <if test="occur_out_qty != null and occur_out_qty !=''" >
        occur_out_qty,
      </if>
      <if test="occur_out_price != null and occur_out_price !=''" >
        occur_out_price,
      </if>
      <if test="occur_spoil_qty != null and occur_spoil_qty !=''" >
        occur_spoil_qty,
      </if>
      <if test="occur_spoil_price != null and occur_spoil_price !=''" >
        occur_spoil_price,
      </if>
      <if test="check_bill_qty != null and check_bill_qty !=''" >
        check_bill_qty,
      </if>
      <if test="check_bill_price != null and check_bill_price !=''" >
        check_bill_price,
      </if>
      <if test="check_store_qty != null and check_store_qty !=''" >
        check_store_qty,
      </if>
      <if test="check_store_price != null and check_store_price !=''" >
        check_store_price,
      </if>
      <if test="check_real_qty != null and check_real_qty !=''" >
        check_real_qty,
      </if>
      <if test="check_real_price != null and check_real_price !=''" >
        check_real_price,
      </if>
      <if test="check_differ_ratio != null and check_differ_ratio !=''" >
        check_differ_ratio,
      </if>
      <if test="check_profit_loss_qty != null and check_profit_loss_qty !=''" >
        check_profit_loss_qty,
      </if>
      <if test="check_profit_loss_price != null and check_profit_loss_price !=''" >
        check_profit_loss_price,
      </if>
      <if test="check_profit_loss_reason != null and check_profit_loss_reason !=''" >
        check_profit_loss_reason,
      </if>
      <if test="is_with_voucher != null and is_with_voucher !=''" >
        is_with_voucher,
      </if>
      <if test="is_dealed_with_voucher != null and is_dealed_with_voucher !=''" >
        is_dealed_with_voucher,
      </if>
      <if test="is_manual_changed != null and is_manual_changed !=''" >
        is_manual_changed,
      </if>
      <if test="liquidate_flag != null and liquidate_flag !=''" >
        liquidate_flag,
      </if>
      <if test="created_at != null and created_at !=''" >
        created_at,
      </if>
      <if test="updated_at != null and updated_at !=''" >
        updated_at,
      </if>
      <if test="status != null and status !=''" >
        status,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >

      <if test="id != null  and id !=''" >
        #{id,jdbcType=INTEGER},
      </if>
      <if test="store_room_id != null and store_room_id !=''" >
        #{store_room_id,jdbcType=INTEGER},
      </if>
      <if test="store_room_name != null and store_room_name !=''" >
        #{store_room_name,jdbcType=VARCHAR},
      </if>
      <if test="mat_id != null and mat_id !=''" >
        #{mat_id,jdbcType=BIGINT},
      </if>
      <if test="mat_no != null and mat_no !=''" >
        #{mat_no,jdbcType=VARCHAR},
      </if>
      <if test="mat_desc != null and mat_desc !=''" >
        #{mat_desc,jdbcType=VARCHAR},
      </if>
      <if test="mat_type_id != null and mat_type_id !=''" >
        #{mat_type_id,jdbcType=BIGINT},
      </if>
      <if test="mat_type_name != null and mat_type_name !=''" >
        #{mat_type_name,jdbcType=VARCHAR},
      </if>
      <if test="mat_model != null and mat_model !=''" >
        #{mat_model,jdbcType=VARCHAR},
      </if>
      <if test="unit != null and unit !=''" >
        #{unit,jdbcType=VARCHAR},
      </if>
      <if test="last_qty != null and last_qty !=''" >
        #{last_qty,jdbcType=DECIMAL},
      </if>
      <if test="last_price != null and last_price !=''" >
        #{last_price,jdbcType=DECIMAL},
      </if>
      <if test="occur_in_qty != null and occur_in_qty !=''" >
        #{occur_in_qty,jdbcType=DECIMAL},
      </if>
      <if test="occur_in_price != null and occur_in_price !=''" >
        #{occur_in_price,jdbcType=DECIMAL},
      </if>
      <if test="occur_out_qty != null and occur_out_qty !=''" >
        #{occur_out_qty,jdbcType=DECIMAL},
      </if>
      <if test="occur_out_price != null and occur_out_price !=''" >
        #{occur_out_price,jdbcType=DECIMAL},
      </if>
      <if test="occur_spoil_qty != null and occur_spoil_qty !=''" >
        #{occur_spoil_qty,jdbcType=DECIMAL},
      </if>
      <if test="occur_spoil_price != null and occur_spoil_price !=''" >
        #{occur_spoil_price,jdbcType=DECIMAL},
      </if>
      <if test="check_bill_qty != null and check_bill_qty !=''" >
        #{check_bill_qty,jdbcType=DECIMAL},
      </if>
      <if test="check_bill_price != null and check_bill_price !=''" >
        #{check_bill_price,jdbcType=DECIMAL},
      </if>
      <if test="check_store_qty != null and check_store_qty !=''" >
        #{check_store_qty,jdbcType=DECIMAL},
      </if>
      <if test="check_store_price != null and check_store_price !=''" >
        #{check_store_price,jdbcType=DECIMAL},
      </if>
      <if test="check_real_qty != null and check_real_qty !=''" >
        #{check_real_qty,jdbcType=DECIMAL},
      </if>
      <if test="check_real_price != null and check_real_price !=''" >
        #{check_real_price,jdbcType=DECIMAL},
      </if>
      <if test="check_differ_ratio != null and check_differ_ratio !=''" >
        #{check_differ_ratio,jdbcType=DECIMAL},
      </if>
      <if test="check_profit_loss_qty != null and check_profit_loss_qty !=''" >
        #{check_profit_loss_qty,jdbcType=DECIMAL},
      </if>
      <if test="check_profit_loss_price != null and check_profit_loss_price !=''" >
        #{check_profit_loss_price,jdbcType=DECIMAL},
      </if>
      <if test="check_profit_loss_reason != null and check_profit_loss_reason !=''" >
        #{check_profit_loss_reason,jdbcType=VARCHAR},
      </if>
      <if test="is_with_voucher != null and is_with_voucher !=''" >
        #{is_with_voucher,jdbcType=BIT},
      </if>
      <if test="is_dealed_with_voucher != null and is_dealed_with_voucher !=''" >
        #{is_dealed_with_voucher,jdbcType=BIT},
      </if>
      <if test="is_manual_changed != null and is_manual_changed !=''" >
        #{is_manual_changed,jdbcType=BIT},
      </if>
      <if test="liquidate_flag != null and liquidate_flag !=''" >
        #{liquidate_flag,jdbcType=CHAR},
      </if>
      <if test="created_at != null and created_at !=''" >
        #{created_at,jdbcType=TIMESTAMP},
      </if>
      <if test="updated_at != null and updated_at !=''" >
        #{updated_at,jdbcType=TIMESTAMP},
      </if>
      <if test="status != null and status !=''" >
        #{status,jdbcType=TINYINT},
      </if>
    </trim>
  </insert>

  <insert id="addStoreCheckBillMatType" parameterType="Map" useGeneratedKeys="true" keyProperty="id" keyColumn="id">
    <selectKey resultType="int" order="AFTER" keyProperty="id">
      SELECT LAST_INSERT_ID() as id
    </selectKey>
    insert into iv_store_check_bill_mat_type
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="check_bill_id != null  and check_bill_id !=''" >
        check_bill_id,
      </if>
      <if test="mat_type_id != null  and mat_type_id !=''" >
        mat_type_id,
      </if>
      <if test="mat_type_name != null  and mat_type_name !=''" >
        mat_type_name,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <if test="check_bill_id!=null and check_bill_id!=''">
        #{check_bill_id,jdbcType=INTEGER},
      </if>
      <if test="mat_type_id!=null and mat_type_id!=''">
        #{mat_type_id,jdbcType=INTEGER},
      </if>
      <if test="mat_type_name!=null and mat_type_name!=''">
        #{mat_type_name,jdbcType=VARCHAR},
      </if>
    </trim>
  </insert>

  <update  id="updateStoreCheckBillSubDetail"  parameterType="Map">
    UPDATE iv_store_check_bill il,iv_store_check_bill_sub  ib
    <set >
      <if test="check_bill_no != null  and check_bill_no!=''" >
          il.check_bill_no=#{check_bill_no},
      </if>
      <if test="approve_step != null  and approve_step!=''" >
        il.approve_step=#{approve_step},
      </if>
      <if test="liquidate_flags != null  and liquidate_flags!=''" >
        il.liquidate_flag=#{liquidate_flags},
      </if>
      <if test="check_profit_loss_price != null  and check_profit_loss_price!=''" >
        ib.check_profit_loss_price=#{check_profit_loss_price},
      </if>
      <if test="check_profit_loss_qty != null  and check_profit_loss_qty!=''" >
        ib.check_profit_loss_qty=#{check_profit_loss_qty},
      </if>
      <if test="check_profit_loss_reason != null  and check_profit_loss_reason!=''" >
        ib.check_profit_loss_reason=#{check_profit_loss_reason},
      </if>
      <if test="check_real_price != null  and check_real_price!=''" >
        ib.check_real_price=#{check_real_price},
      </if>
      <if test="check_differ_ratio != null  and check_differ_ratio!=''" >
        ib.check_differ_ratio=#{check_differ_ratio},
      </if>
      <if test="check_profit_loss_qty != null  and check_profit_loss_qty!=''" >
        ib.check_profit_loss_qty=#{check_profit_loss_qty},
      </if>
      <if test="check_real_qty != null  and check_real_qty!=''" >
        ib.check_real_qty=#{check_real_qty},
      </if>
      <if test="liquidate_flag != null  and liquidate_flag!=''" >
        ib.liquidate_flag=#{liquidate_flag},
      </if>
    </set>
    where ib.check_bill_id=#{check_bill_id}
            and il.id=#{id}
  </update>

 <update id="updateStoreCheckMatIdDetail"  parameterType="Map">
   UPDATE iv_store_check_bill il,iv_store_check_bill_sub  ib
   <set >
     <if test="check_bill_no != null  and check_bill_no!=''" >
       il.check_bill_no=#{check_bill_no},
     </if>
     <if test="liquidate_flags != null  and liquidate_flags!=''" >
       il.liquidate_flag=#{liquidate_flags},
     </if>
     <if test="approve_step != null  and approve_step!=''" >
       il.approve_step=#{approve_step},
     </if>
     <if test="check_profit_loss_price != null  and check_profit_loss_price!=''" >
       ib.check_profit_loss_price=#{check_profit_loss_price},
     </if>
     <if test="check_profit_loss_qty != null  and check_profit_loss_qty!=''" >
       ib.check_profit_loss_qty=#{check_profit_loss_qty},
     </if>
     <if test="check_profit_loss_reason != null  and check_profit_loss_reason!=''" >
       ib.check_profit_loss_reason=#{check_profit_loss_reason},
     </if>
     <if test="check_real_price != null  and check_real_price!=''" >
       ib.check_real_price=#{check_real_price},
     </if>
     <if test="check_differ_ratio != null  and check_differ_ratio!=''" >
       ib.check_differ_ratio=#{check_differ_ratio},
     </if>
     <if test="check_profit_loss_qty != null  and check_profit_loss_qty!=''" >
       ib.check_profit_loss_qty=#{check_profit_loss_qty},
     </if>
     <if test="check_real_qty != null  and check_real_qty!=''" >
       ib.check_real_qty=#{check_real_qty},
     </if>
     <if test="liquidate_flag != null  and liquidate_flag!=''" >
       ib.liquidate_flag=#{liquidate_flag},
     </if>
   </set>
   where ib.check_bill_id=#{check_bill_id}
   and il.id=#{id}
   <if test="mat_id!=null  and  mat_id!=''">
     and ib.mat_id=#{mat_id}
   </if>
 </update>

  <select  id="selectStoreCheckBillSubDetail" resultType="map" parameterType="java.lang.Long">
    SELECT check_bill_price, check_bill_qty, id AS check_detail_id, check_differ_ratio, check_profit_loss_price
    , check_profit_loss_qty, check_profit_loss_reason, check_real_price, check_real_qty, is_dealed_with_voucher
    , is_manual_changed, is_with_voucher, last_price, last_qty, liquidate_flag, mat_desc, mat_id, mat_model
    , mat_no, mat_type_id, mat_type_name, occur_in_price, occur_in_qty, occur_out_price, occur_out_qty, occur_spoil_price
    , occur_spoil_qty, store_room_id, store_room_name, unit FROM iv_store_check_bill_sub
    WHERE check_bill_id = #{check_bill_id} AND STATUS = 1
  </select>


  <select id="selectNoStoreCheckMat" parameterType="java.lang.Long"  resultType="map">
    SELECT il.id, il.check_bill_no, ib.check_bill_price, il.liquidate_flag AS liquidate_flags, ib.check_bill_qty
    , ib.id AS check_detail_id, ib.check_differ_ratio, ib.check_profit_loss_price, ib.check_profit_loss_qty, ib.check_profit_loss_reason
    , ib.check_real_price, ib.check_real_qty, ib.liquidate_flag, ib.mat_desc, ib.mat_id
    , ib.mat_model, ib.mat_no, ib.mat_type_id, ib.mat_type_name, ib.store_room_id
    , ib.store_room_name, il.store_house_id, il.store_house_name, ib.unit, ib.check_bill_id
    FROM iv_store_check_bill il
    INNER JOIN iv_store_check_bill_sub ib ON il.id = ib.check_bill_id
      <where>
        <if test="check_bill_id != null and check_bill_id!= ''">
          And il.id=#{check_bill_id}
        </if>
        And ib.liquidate_flag=2 AND il.status=1
      </where>
  </select>
</mapper>