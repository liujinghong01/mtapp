webpackJsonp([22],{291:function(e,t,n){n(611);var a=n(0)(n(448),n(720),"data-v-2f6b8112",null);e.exports=a.exports},328:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={name:"cstItem",data:function(){return{selectId:"select-"+Math.random().toString(36).substring(3,6)}},props:{label:{type:String,required:!0},value:{type:"",default:""},placeholder:{type:String,default:""},canEdit:{type:Boolean,default:!0},hasArrow:{type:Boolean,default:!1},arrowText:{type:[String,Number],default:""},arrowClick:{type:Function},editType:{type:String,default:"text"},isSelect:{type:Boolean,default:!1},options:{type:Array},action:{type:String,default:"check"},color:""},methods:{noteClick:function(){this.arrowClick&&this.arrowClick()},input:function(e){var t=e.target.value;this.$emit("input",t)}}}},329:function(e,t,n){t=e.exports=n(220)(),t.push([e.i,"\n.compute-item[data-v-19336c8e] {\n  min-height: 49px;\n  position: relative;\n  padding: 12px 15px;\n  background-color: white;\n  display: -ms-flexbox;\n  display: flex;\n}\n.compute-item.noneBorder > .hairlineTop[data-v-19336c8e]:before {\n    background: red;\n}\n.compute-item .arrow[data-v-19336c8e] {\n    color: #DDD;\n    position: absolute;\n    right: 15px;\n    top: 14px;\n    font-size: 20px;\n}\n.compute-item .arrow.down[data-v-19336c8e] {\n      top: 13px;\n}\n.compute-item .label[data-v-19336c8e] {\n    -ms-flex: 0 0  auto;\n        flex: 0 0  auto;\n    height: 100%;\n    display: table;\n    padding: 7px 10px 7px 0px;\n    max-width: 52%;\n    color: #484746;\n    text-align: left;\n    line-height: 12px;\n}\n.compute-item .value[data-v-19336c8e] {\n    -ms-flex: 1 0 auto;\n        flex: 1 0 auto;\n    text-align: right;\n}\n.compute-item .value input[data-v-19336c8e] {\n      margin: 0;\n      padding: 0;\n      border: none;\n      color: #ababab;\n      width: 100%;\n      height: 24px;\n      line-height: 24px;\n      text-align: right;\n      text-overflow: ellipsis;\n      white-space: nowrap;\n      overflow: hidden;\n}\n.compute-item .value span[data-v-19336c8e] {\n      height: 24px;\n      line-height: 24px;\n}\n.compute-item .value span.color[data-v-19336c8e] {\n        display: inline-block;\n        width: 20px;\n        height: 20px;\n        border-radius: 50%;\n}\n.compute-item .note[data-v-19336c8e] {\n    -ms-flex: 0 0 5%;\n        flex: 0 0 5%;\n}\n.compute-item .note .item-notes[data-v-19336c8e] {\n      float: right;\n      color: #ababab;\n      line-height: 24px;\n      /*padding: 0 5px;*/\n      padding-right: 15px;\n}\n","",{version:3,sources:["E:/weibosi/webs-mt/mt/www_dev/src/components/cstItem.vue"],names:[],mappings:";AACA;EACE,iBAAiB;EACjB,mBAAmB;EACnB,mBAAmB;EACnB,wBAAwB;EACxB,qBAAqB;EACrB,cAAc;CACf;AACD;IACI,gBAAgB;CACnB;AACD;IACI,YAAY;IACZ,mBAAmB;IACnB,YAAY;IACZ,UAAU;IACV,gBAAgB;CACnB;AACD;MACM,UAAU;CACf;AACD;IACI,oBAAoB;QAChB,gBAAgB;IACpB,aAAa;IACb,eAAe;IACf,0BAA0B;IAC1B,eAAe;IACf,eAAe;IACf,iBAAiB;IACjB,kBAAkB;CACrB;AACD;IACI,mBAAmB;QACf,eAAe;IACnB,kBAAkB;CACrB;AACD;MACM,UAAU;MACV,WAAW;MACX,aAAa;MACb,eAAe;MACf,YAAY;MACZ,aAAa;MACb,kBAAkB;MAClB,kBAAkB;MAClB,wBAAwB;MACxB,oBAAoB;MACpB,iBAAiB;CACtB;AACD;MACM,aAAa;MACb,kBAAkB;CACvB;AACD;QACQ,sBAAsB;QACtB,YAAY;QACZ,aAAa;QACb,mBAAmB;CAC1B;AACD;IACI,iBAAiB;QACb,aAAa;CACpB;AACD;MACM,aAAa;MACb,eAAe;MACf,kBAAkB;MAClB,mBAAmB;MACnB,oBAAoB;CACzB",file:"cstItem.vue",sourcesContent:["\n.compute-item[data-v-19336c8e] {\n  min-height: 49px;\n  position: relative;\n  padding: 12px 15px;\n  background-color: white;\n  display: -ms-flexbox;\n  display: flex;\n}\n.compute-item.noneBorder > .hairlineTop[data-v-19336c8e]:before {\n    background: red;\n}\n.compute-item .arrow[data-v-19336c8e] {\n    color: #DDD;\n    position: absolute;\n    right: 15px;\n    top: 14px;\n    font-size: 20px;\n}\n.compute-item .arrow.down[data-v-19336c8e] {\n      top: 13px;\n}\n.compute-item .label[data-v-19336c8e] {\n    -ms-flex: 0 0  auto;\n        flex: 0 0  auto;\n    height: 100%;\n    display: table;\n    padding: 7px 10px 7px 0px;\n    max-width: 52%;\n    color: #484746;\n    text-align: left;\n    line-height: 12px;\n}\n.compute-item .value[data-v-19336c8e] {\n    -ms-flex: 1 0 auto;\n        flex: 1 0 auto;\n    text-align: right;\n}\n.compute-item .value input[data-v-19336c8e] {\n      margin: 0;\n      padding: 0;\n      border: none;\n      color: #ababab;\n      width: 100%;\n      height: 24px;\n      line-height: 24px;\n      text-align: right;\n      text-overflow: ellipsis;\n      white-space: nowrap;\n      overflow: hidden;\n}\n.compute-item .value span[data-v-19336c8e] {\n      height: 24px;\n      line-height: 24px;\n}\n.compute-item .value span.color[data-v-19336c8e] {\n        display: inline-block;\n        width: 20px;\n        height: 20px;\n        border-radius: 50%;\n}\n.compute-item .note[data-v-19336c8e] {\n    -ms-flex: 0 0 5%;\n        flex: 0 0 5%;\n}\n.compute-item .note .item-notes[data-v-19336c8e] {\n      float: right;\n      color: #ababab;\n      line-height: 24px;\n      /*padding: 0 5px;*/\n      padding-right: 15px;\n}\n"],sourceRoot:""}])},330:function(e,t,n){var a=n(329);"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);n(221)("6ea14c28",a,!0)},331:function(e,t,n){n(330);var a=n(0)(n(328),n(332),"data-v-19336c8e",null);e.exports=a.exports},332:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"compute-item"},[n("span",{staticClass:"label"},[e._v(e._s(e.label))]),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:"color"!==e.editType,expression:"editType!=='color'"}],staticClass:"value"},[e.canEdit&&"check"!==e.action&&"approve"!==e.action?"check"!==e.action||"approve"!==e.action?n("input",{ref:"input",attrs:{type:e.editType,placeholder:e.placeholder},domProps:{value:e.value},on:{input:e.input}}):e._e():n("span",[e._v(e._s(e.value))])]),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:"color"===e.editType,expression:"editType==='color'"}],staticClass:"value"},[n("span",{staticClass:"color",style:{background:e.color}})]),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.hasArrow,expression:"hasArrow"}],staticClass:"note"},[n("span",{directives:[{name:"show",rawName:"v-show",value:e.hasArrow&&e.arrowText,expression:"hasArrow&&arrowText"}],staticClass:"item-notes",on:{click:e.noteClick}},[e._v(e._s(e.arrowText))]),e._v(" "),n("i",{directives:[{name:"show",rawName:"v-show",value:e.hasArrow,expression:"hasArrow"}],staticClass:"icon ion-ios-arrow-right arrow "})]),e._v(" "),n("div",{staticClass:"hairline-top"})])},staticRenderFns:[]}},347:function(e,t,n){"use strict";function a(e){return n.i(o.a)({url:"/api/workflow/process",method:"post",data:e})}function i(e){return n.i(o.a)({url:"/api/workflow/show_opinion",method:"post",data:e})}t.a=a,t.b=i;var o=n(7)},348:function(e,t,n){"use strict";function a(e){return n.i(l.a)({url:"/api/pc/query/requestList",method:"post",data:e})}function i(e){return n.i(l.a)({url:"/api/pc/query/request",method:"post",data:e})}function o(e){return n.i(l.a)({url:"/api/pc/request/delete",method:"post",data:e})}function s(e){return n.i(l.a)({url:"/api/pc/request/deleteLine",method:"post",data:e})}function r(e){return n.i(l.a)({url:"/api/pc/request/referHis",method:"post",data:e})}function c(e){return n.i(l.a)({url:"/api/pc/request/modify",method:"post",data:e})}function d(e){return n.i(l.a)({url:"/api/pc/request/modifyLine",method:"post",data:e})}t.a=a,t.d=i,t.g=o,t.e=s,t.b=r,t.f=c,t.c=d;var l=n(7)},448:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(8),i=n.n(a),o=n(13),s=n.n(o),r=n(331),c=n.n(r),d=n(348),l=n(20),p=n.n(l),u=n(48),h=n(347),v=n(4);n(1);t.default={name:"requisitionDetail",components:{SwipeItem:p.a,CstItem:c.a},data:function(){return{tabIndex:0,request_id:"",action:"check",head_info:{dep_id:"",dep_name:"",reason:"",request_date:n.i(u.a)(),request_id:"",request_man:"",request_man_name:"",request_no:"",line_list:[]}}},mounted:function(){this.action=this.$route.params.action,"new"!==this.action&&(this.request_id=this.$route.params.request_id)},computed:s()({},n.i(v.a)(["userinfo","chosenCompany"])),activated:function(){this.request_id&&"new"!=this.action&&this.getDetail()},methods:{getDetail:function(){var e=this,t={query:{request_id:this.request_id}};n.i(d.d)(t).then(function(t){e.head_info=t.head_info,e.request_id=t.head_info.request_id,console.log(t)}).catch(function(e){$toast.show(e.description)})},onTabClick:function(e){if(!this.request_id)return void $toast.show("请先保存头信息");this.tabIndex=e},submit:function(){var e=this;if("edit"===this.action)return void $toast.show("请先保存头信息");if("approve"===this.action)this.$router.forward("/approve/approve/"+this.head_info.request_id+"/4/"+this.head_info.approve_step);else{var t={bill_id:this.request_id,bill_type:"4",approve_flag:"1",approve_step:this.head_info.approve_step?this.head_info.approve_step:"step10"};n.i(h.a)(t).then(function(t){$toast.show("提交成功"),e.$router.go(-1)}).catch(function(e){$toast.show(e.description)})}},checkApprove:function(){this.$router.forward("/approve/approveSuggests/"+this.head_info.request_id+"/4")},onItemClick:function(e){this.$router.forward({path:"/purchase/requisition/lineInfo/"+this.action,query:{line_info:i()(e)}})},delItem:function(e){var t=this;$dialog.confirm({theme:"ios",title:"确定要删除"+e.mat_desc+"吗？",cancelText:"取消",okText:"确定"}).then(function(a){if(a){var i={line_ids:[e.line_id]};n.i(d.e)(i).then(function(n){t.head_info.line_list=t.head_info.line_list.filter(function(t){return t.line_id!==e.line_id})}).catch(function(e){$toast.show(e.description)})}})},saveHead:function(){var e=this;this.head_info.dep_id=this.chosenCompany.deps[0].dep_id,this.head_info.dep_name=this.chosenCompany.deps[0].dep_name,this.head_info.request_man=this.userinfo.uid,this.head_info.request_man_name=this.chosenCompany.deps[0].work_name;var t={head_info:this.head_info};n.i(d.f)(t).then(function(t){e.request_id=t.request_id,e.head_info.request_no=t.request_no,$toast.show("保存成功"),e.action="check",console.log(t)}).catch(function(e){$toast.show(e.description)})}}}},510:function(e,t,n){t=e.exports=n(220)(),t.push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"detail.vue",sourceRoot:""}])},611:function(e,t,n){var a=n(510);"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);n(221)("6a44aa28",a,!0)},720:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{directives:[{name:"nav",rawName:"v-nav",value:{hideNavbar:!0},expression:"{hideNavbar:true}"}],staticClass:"mw-page page purchase"},[n("div",{staticClass:"mw-page-header"},[n("i",{staticClass:"left icon ion-ios-arrow-back",on:{click:function(t){e.$router.go(-1)}}}),e._v(" "),n("span",[e._v("请购单详情")]),e._v(" "),"check"===e.action?n("i",{staticClass:"right",on:{click:function(t){e.action="edit"}}},[e._v("编辑")]):"edit"===e.action?n("i",{staticClass:"right",on:{click:function(t){e.action="check"}}},[e._v("取消")]):n("i",{staticClass:"right"})]),e._v(" "),n("div",{staticClass:"mw-page-content has-tab"},[n("div",[n("div",{staticClass:"mw-tab"},[n("ul",{staticClass:"tab-content"},[n("li",{class:{active:0===e.tabIndex},on:{click:function(t){e.onTabClick(0)}}},[e._v("头信息")]),e._v(" "),n("li",{class:{active:1===e.tabIndex},on:{click:function(t){e.onTabClick(1)}}},[e._v("行信息")])])])]),e._v(" "),n("div",{staticStyle:{flex:"1","overflow-y":"scroll"}},[n("div",{staticClass:"divider"}),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:0===e.tabIndex,expression:"tabIndex===0"}],staticClass:"content"},[n("cst-item",{directives:[{name:"show",rawName:"v-show",value:e.head_info.request_no,expression:"head_info.request_no"}],attrs:{label:"请购单号",action:e.action,canEdit:!1},model:{value:e.head_info.request_no,callback:function(t){e.$set(e.head_info,"request_no",t)},expression:"head_info.request_no"}}),e._v(" "),"new"===e.action?n("div",[e.chosenCompany.deps&&e.chosenCompany.deps.length>0?n("cst-item",{attrs:{label:"经办人",action:e.action,canEdit:!1},model:{value:e.chosenCompany.deps[0].work_name,callback:function(t){e.$set(e.chosenCompany.deps[0],"work_name",t)},expression:"chosenCompany.deps[0].work_name"}}):e._e(),e._v(" "),e.chosenCompany.deps&&e.chosenCompany.deps.length>0?n("cst-item",{attrs:{label:"请购部门",action:e.action,canEdit:!1},model:{value:e.chosenCompany.deps[0].dep_name,callback:function(t){e.$set(e.chosenCompany.deps[0],"dep_name",t)},expression:"chosenCompany.deps[0].dep_name"}}):e._e()],1):n("div",[n("cst-item",{attrs:{label:"经办人",action:e.action,canEdit:!1},model:{value:e.head_info.request_man_name,callback:function(t){e.$set(e.head_info,"request_man_name",t)},expression:"head_info.request_man_name"}}),e._v(" "),n("cst-item",{attrs:{label:"请购部门",action:e.action,canEdit:!1},model:{value:e.head_info.dep_name,callback:function(t){e.$set(e.head_info,"dep_name",t)},expression:"head_info.dep_name"}})],1),e._v(" "),"check"===e.action?n("cst-item",{attrs:{label:"请购时间",action:e.action},model:{value:e.head_info.request_date,callback:function(t){e.$set(e.head_info,"request_date",t)},expression:"head_info.request_date"}}):n("datepicker",{attrs:{label:"请购时间","date-format":"yyyy-mm-dd"},model:{value:e.head_info.request_date,callback:function(t){e.$set(e.head_info,"request_date",t)},expression:"head_info.request_date"}}),e._v(" "),n("div",{staticClass:"item-divider",staticStyle:{"padding-left":"15px"}},[e._v("备注")]),e._v(" "),n("textarea",{directives:[{name:"model",rawName:"v-model",value:e.head_info.reason,expression:"head_info.reason"}],staticStyle:{margin:"0"},attrs:{disabled:"check"===e.action},domProps:{value:e.head_info.reason},on:{input:function(t){t.target.composing||e.$set(e.head_info,"reason",t.target.value)}}})],1),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:1===e.tabIndex,expression:"tabIndex===1"}],staticClass:"content"},e._l(e.head_info.line_list,function(t){return n("div",[n("swipe-item",{attrs:{swipeItemText:"删除",obj:t},on:{SwipeItemClick:function(n){e.delItem(t)},ItemClick:function(n){e.onItemClick(t)}}},[n("div",{staticClass:"req-item"},[n("div",{staticClass:"req-item-title"},[e._v("物料编码 ："),n("span",{staticClass:"vi-color"},[e._v(e._s(t.mat_no))])]),e._v(" "),n("div",{staticClass:"req-item-content"},[n("span",[e._v("类型 : "+e._s(t.mat_type_name))]),e._v(" "),n("span",[e._v("数量 : "+e._s(t.quantity))]),e._v(" "),n("span",[e._v("单价 : "+e._s(t.up))]),e._v(" "),n("span",[e._v("金额 : "+e._s(t.price))])])])])],1)}))])]),e._v(" "),"approve"===e.action?n("div",{staticClass:"mw-page-footer"},[n("div",{staticClass:"btns"},[n("div",{staticClass:"btn",on:{click:e.submit}},[e._v("\n        审批\n      ")])])]):e._e(),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:"new"===e.action||"edit"===e.action,expression:"action==='new'||action==='edit'"}],staticClass:"mw-page-footer"},[n("div",{staticClass:"btns"},[n("div",{staticClass:"btn",on:{click:e.saveHead}},[e._v("\n        保存\n      ")]),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:1===e.tabIndex,expression:"tabIndex===1"}],staticClass:"divider"}),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:1===e.tabIndex,expression:"tabIndex===1"}],staticClass:"btn",on:{click:function(t){e.$router.forward({path:"/purchase/requisition/lineInfo/new",query:{line_info:e.request_id}})}}},[e._v("\n        新增\n      ")])])]),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:"check"===e.action&&("step10"===e.head_info.approve_step||"step11"===e.head_info.approve_step),expression:"action==='check' && (head_info.approve_step==='step10' || head_info.approve_step==='step11')"}],staticClass:"mw-page-footer"},[n("div",{staticClass:"btns"},[n("div",{staticClass:"btn",on:{click:e.submit}},[e._v("\n        提交审批\n      ")])])])])},staticRenderFns:[]}}});
//# sourceMappingURL=22.8fc4c55fdb6dbe94c83e.js.map