webpackJsonp([99],{325:function(e,t,i){i(754);var s=i(0)(i(524),i(901),"data-v-3b208cd6",null);e.exports=s.exports},414:function(e,t,i){"use strict";function s(e){return i.i(n.a)({url:"/api/pc/mat_require_plan/list",method:"post",data:e})}function c(e){return i.i(n.a)({url:"api/pc/mat_require_plan/detail",method:"post",data:e})}function a(e){return i.i(n.a)({url:"/api/dict/query_supplier_by_mat",method:"post",data:e})}t.c=s,t.a=c,t.b=a;var n=i(10)},524:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i(6),c=i.n(s),a=i(414),n=i(1);t.default={name:"requirements",data:function(){return{check:!1,showFilter:!1,isCheckAll:!0,pageModel:{curr_page:0,total_page:0,page_size:10},require_list:[],query:{create_type:[],mat_desc:""},types:[{code:1,value:"Bom"},{code:2,value:"外协"},{code:3,value:"请购单"},{code:4,value:"仓库报警"},{code:5,value:"库存下料"},{code:6,value:"工序转外协"}]}},computed:{checkedMats:function(){return this.require_list.filter(function(e){return!0===e.check})}},methods:{onInfinite:function(e){var t=this;if(t.pageModel.total_page<=t.pageModel.curr_page)return void e();setTimeout(function(){t.pageModel.total_page<2?e():(t.getData(),e())},400)},onRefresh:function(e){var t=this;setTimeout(function(){t.getData(!0),e()},500)},onItemClick:function(e){this.$router.forward("/purchase/requirements/detail/"+e.require_id)},createPurchase:function(){var e=this;if(0===this.checkedMats.length)return void $toast.show("请先选择物料");var t=[];this.checkedMats.forEach(function(e,i){t.push(e.mat_id)});var s={query:{mat_ids:t}};i.i(a.b)(s).then(function(t){t.sup_list.length<1?$toast.show("所选物料不属于同一家供应商",600):(n.a.set("mats",c()(e.checkedMats)),e.$router.forward("/purchase/purchase/detail/new/null"))}).catch(function(e){$toast.show(e.description)})},inquiry:function(){if(0===this.checkedMats.length)return void $toast.show("请先选择物料");n.a.set("mats",c()(this.checkedMats)),console.log(this.checkedMats),this.$router.forward("/purchase/inquiry/feedback/new/null")},getData:function(e){var t=this,s={curr_page:e?1:1+this.pageModel.curr_page,page_size:this.pageModel.page_size,query:this.query};i.i(a.c)(s).then(function(i){e&&(t.require_list.length=0,t.showFilter=!1),t.pageModel.curr_page=i.curr_page,t.pageModel.total_page=i.total_page,t.require_list=t.require_list.concat(i.require_list)}).catch(function(e){$toast.show(e.description)})},checkAll:function(){var e=this;this.isCheckAll=!this.isCheckAll,this.require_list.forEach(function(t){e.isCheckAll?e.$set(t,"check",!1):e.$set(t,"check",!0)})},checkType:function(e){if(this.$set(e,"checked",!e.checked),e.checked)this.query.create_type.push(e.code);else{var t=this.query.create_type.indexOf(e.code);this.query.create_type.splice(t,1)}},delItems:function(){0!==this.checkedMats.length&&$dialog.confirm({theme:"ios",title:"确定要删除这"+this.checkedMats.length+"项吗？",cancelText:"取消",confirmText:"确定"}).then(function(e){})},reset:function(){this.types.forEach(function(e){e.checked=!1}),this.query.create_type=[]}},mounted:function(){this.getData(!0)},activated:function(){this.getData(!0)}}},615:function(e,t,i){t=e.exports=i(225)(),t.push([e.i,"\n.item-divider[data-v-3b208cd6] {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n}\n","",{version:3,sources:["/Users/zxf/code/motooling/mt-app/webs-mtapp/mtApp/mt/www_dev/src/views/purchase/requirements/index.vue"],names:[],mappings:";AACA;EACE,mBAAmB;EACnB,OAAO;EACP,QAAQ;EACR,YAAY;CACb",file:"index.vue",sourcesContent:["\n.item-divider[data-v-3b208cd6] {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n}\n"],sourceRoot:""}])},754:function(e,t,i){var s=i(615);"string"==typeof s&&(s=[[e.i,s,""]]),s.locals&&(e.exports=s.locals);i(226)("668b0c4e",s,!0)},901:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{directives:[{name:"nav",rawName:"v-nav",value:{hideNavbar:!0},expression:"{hideNavbar:true}"}],staticClass:"mw-page page purchase"},[i("div",{staticClass:"mw-page-header"},[i("i",{staticClass:"left icon ion-ios-arrow-back",on:{click:function(t){e.$router.go(-1)}}}),e._v(" "),i("span",[e._v("物料需求计划列表")]),e._v(" "),e.check?e._e():i("i",{staticClass:"right",on:{click:function(t){e.check=!0}}},[e._v("操作")]),e._v(" "),e.check?i("i",{staticClass:"right",on:{click:function(t){e.check=!1}}},[e._v("取消")]):e._e()]),e._v(" "),i("div",{staticClass:"mw-page-content",staticStyle:{position:"relative","padding-top":"35px"}},[i("div",{staticClass:"item-divider"},[i("span",{directives:[{name:"show",rawName:"v-show",value:e.check,expression:"check"}],staticStyle:{"padding-left":"15px",float:"left",color:"#416eb6"},on:{click:e.checkAll}},[e._v("全选")]),e._v(" "),e.check?e._e():i("span",{staticStyle:{float:"right","padding-right":"15px",color:"#416eb6"},on:{click:function(t){e.showFilter=!0}}},[e._v("筛选")]),e._v(" "),e.check?i("span",{staticStyle:{float:"right","padding-right":"15px",color:"#416eb6"},on:{click:e.delItems}},[e._v("删除("+e._s(e.checkedMats.length)+")")]):e._e()]),e._v(" "),i("div",{staticClass:"content"},[i("scroll",{staticClass:"page-content",staticStyle:{"-webkit-overflow-scrolling":"touch"},attrs:{"on-infinite":e.onInfinite,"on-refresh":e.onRefresh}},[e._l(e.require_list,function(t){return i("div",[i("item",{class:["req-item",e.check?"check":""]},[i("div",{staticClass:"checkBox",on:{click:function(i){e.$set(t,"check",!t.check)}}},[i("i",{class:["icon",t.check?"ion-android-checkbox active":"ion-android-checkbox-outline-blank"]})]),e._v(" "),i("div",{staticClass:"req-item-detail",on:{click:function(i){e.onItemClick(t)}}},[i("div",{staticClass:"req-item-title"},[e._v("物料描述 ："),i("span",{staticClass:"vi-color"},[e._v(e._s(t.mat_desc))]),i("i",{staticClass:"icon ion-ios-arrow-right"})]),e._v(" "),i("div",{staticClass:"req-item-title"},[e._v("物料编码 ："),i("span",{staticClass:"vi-color"},[e._v(e._s(t.mat_no))])]),e._v(" "),i("div",{staticClass:"req-item-content"},[i("span",[e._v("需求来源 : "+e._s(t.create_type_name))]),i("span",[e._v("当前需求量 : "+e._s(t.plan_qty-t.buy_qty))]),e._v(" "),i("span",[e._v("物料类型 : "+e._s(t.mat_type_name))]),i("span",[e._v("金额 : "+e._s(t.total_price))])])])])],1)}),e._v(" "),e.pageModel.curr_page>=e.pageModel.total_page?i("div",{staticClass:"text-center",attrs:{slot:"infinite"},slot:"infinite"},[e._v("没有更多数据")]):e._e()],2)],1)]),e._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:e.showFilter,expression:"showFilter"}],staticClass:"mask",on:{click:function(t){e.showFilter=!1}}}),e._v(" "),i("div",{class:e.showFilter?"filter active":"filter"},[i("div",{directives:[{name:"show",rawName:"v-show",value:e.showFilter,expression:"showFilter"}],staticClass:"item ",staticStyle:{"text-align":"center"}},[e._v("\n      筛选\n    ")]),e._v(" "),i("list",{directives:[{name:"show",rawName:"v-show",value:e.showFilter,expression:"showFilter"}],staticStyle:{position:"relative"}},[i("br"),e._v(" "),i("span",{staticStyle:{padding:"10px"}},[e._v("物料来源")]),e._v(" "),i("ul",{staticClass:"types"},e._l(e.types,function(t){return i("li",{key:t.code,class:t.checked?"active":"",on:{click:function(i){e.checkType(t)}}},[e._v(e._s(t.value))])}))]),e._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:e.showFilter,expression:"showFilter"}],staticClass:"btns"},[i("div",{staticClass:"btn reset",on:{click:e.reset}},[e._v("重置")]),e._v(" "),i("div",{staticClass:"btn",staticStyle:{"background-color":"#416eb6"},on:{click:function(t){e.getData(!0)}}},[e._v("确定")])])],1),e._v(" "),e.check?i("div",{staticClass:"mw-page-footer"},[e.check?i("div",{staticClass:"btns"},[i("div",{staticClass:"btn",on:{click:e.createPurchase}},[e._v("\n        采购\n      ")]),e._v(" "),i("div",{staticClass:"divider"}),e._v(" "),i("div",{staticClass:"btn",on:{click:e.inquiry}},[e._v("\n        询价\n      ")])]):e._e()]):e._e()])},staticRenderFns:[]}}});
//# sourceMappingURL=99.a228574992b968a7892e.js.map