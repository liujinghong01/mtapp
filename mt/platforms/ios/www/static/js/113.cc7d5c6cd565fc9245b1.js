webpackJsonp([113],{284:function(t,a,n){n(825);var e=n(0)(n(482),n(973),"data-v-a55ca0ec",null);t.exports=e.exports},375:function(t,a,n){"use strict";function e(t){return n.i(m.a)({url:"/api/iv/storehouse/modify",method:"post",data:t})}function i(t){return n.i(m.a)({url:"/api/iv/storehouse/list",method:"post",data:t})}function s(t){return n.i(m.a)({url:"/api/iv/storehouse/detail",method:"post",data:t})}function o(t){return n.i(m.a)({url:"/api/iv/storehouse/delete",method:"post",data:t})}function c(t){return n.i(m.a)({url:"/api/iv/storeroom/delete",method:"post",data:t})}function u(t){return n.i(m.a)({url:"/api/iv/mat_type/list",method:"post",data:t})}function r(t){return n.i(m.a)({url:"/api/iv/mat_type/modify",method:"post",data:t})}function l(t){return n.i(m.a)({url:"/api/iv/store_room/search_mat",method:"post",data:t})}function d(t){return n.i(m.a)({url:"/api/iv/store/search_mat",method:"post",data:t})}function h(t){return n.i(m.a)({url:"/api/pm/mold_mat_req/list",method:"post",data:t})}a.i=e,a.e=i,a.g=s,a.j=o,a.h=c,a.d=u,a.f=r,a.c=l,a.a=d,a.b=h;var m=n(10)},482:function(t,a,n){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var e=n(6),i=n.n(e),s=n(375),o=n(21),c=n.n(o),u=n(1);a.default={name:"MaterialList",data:function(){return{matSearch:"",matList:[],list:[],house_id:"",chosenMats:[],action:"check",type:"",bom_type:"",mold_no:""}},mounted:function(){var t=this.$route.query;this.type=t.type,this.bom_type=t.bom_type,this.mold_no=t.mold_no;var a=[];null!==u.a.get("matList")&&(a=JSON.parse(u.a.get("matList"))),a.length>0?(this.chosenMats=a,u.a.remove("matList"),console.log("获取本地储存成功2"+a)):console.log("获取本地储存为空2"+a),1*this.type==1&&this.moldMatReq()},methods:{cancel:function(){this.action="action"},searchMats:c.a.debounce(function(){this.storeSearchMat()},1e3),storeSearchMat:function(){var t=this;n.i(s.a)({query:{mat_desc:"",mat_id:"",mat_model:"",mat_no:this.matSearch}}).then(function(a){a.store_mat_list.length>0?(t.matList=a.store_mat_list,t.chosenMats.length>0&&t.matList.forEach(function(a,n){t.chosenMats.forEach(function(n,e){a.mat_no===n.mat_no&&t.$set(a,"quantity",n.quantity)})})):($toast.show("结果查询为空"),t.matList=[])}).catch(function(t){$toast.show(t.description)})},moldMatReq:function(){var t=this;n.i(s.b)({query:{apply_type:this.type,bom_type:this.bom_type,mold_no:this.mold_no}}).then(function(a){a.req_list.length>0?(t.matList=a.req_list,t.chosenMats.length>0&&t.matList.forEach(function(a,n){t.chosenMats.forEach(function(n,e){a.mat_no===n.mat_no&&t.$set(a,"quantity",n.quantity)})})):($toast.show("结果查询为空"),t.matList=[])}).catch(function(t){$toast.show(t.description)})},addCount:function(t){t.quantity?("1"===this.type?t.quantity<t.undeal_qty?t.quantity++:t.quantity=t.undeal_qty:t.quantity<t.stock_qty?t.quantity++:t.quantity=t.stock_qty,this.chosenMats.forEach(function(a,n){a.mat_id==t.mat_id&&(a.quantity=t.quantity)})):(this.$set(t,"quantity",1),this.chosenMats.push(t))},countChange:function(t){t.quantity<=0&&(t.quantity=1),"1"===this.type?t.quantity>t.undeal_qty&&(t.quantity=t.undeal_qty):t.quantity>t.stock_qty&&(t.quantity=t.stock_qty),this.chosenMats.forEach(function(a,n){a.mat_id==t.mat_id&&(a.quantity=t.quantity)})},minCount:function(t){var a=this;if(1===t.quantity)return void $dialog.confirm({theme:"ios",title:"要删除物料吗？",okText:"确定",cancelText:"取消"}).then(function(n){n&&(t.quantity=0,a.chosenMats.forEach(function(n,e){n.mat_id==t.mat_id&&(t.checked=!1,a.chosenMats.splice(e,1))}))});this.$set(t,"quantity",--t.quantity),this.chosenMats.forEach(function(a,n){a.mat_id==t.mat_id&&(a.quantity=t.quantity)})},ok:function(){if(0===this.chosenMats.length)return void $toast.show("请选择物料");if(this.chosenMats.length>0){var t=i()(this.chosenMats);u.a.set("mats",t),console.log("本地储存成功2"+t)}else console.log("本地储存为空2");$router.go(-1)}},computed:{totalCount:function(){var t=0;return this.chosenMats.filter(function(a){t+=a.quantity}),"总数量"+t}},watch:{matSearch:function(){this.searchMats()}}}},686:function(t,a,n){a=t.exports=n(225)(),a.push([t.i,"\n.total[data-v-a55ca0ec] {\n  -ms-flex: 0 0 80%;\n      flex: 0 0 80%;\n}\n.total span[data-v-a55ca0ec] {\n    -ms-flex: 1 0 auto;\n        flex: 1 0 auto;\n    text-align: center;\n}\n.icon-saoyisao[data-v-a55ca0ec] {\n  float: left;\n  display: block;\n  width: 15%;\n  text-align: center;\n  line-height: 34px;\n}\n","",{version:3,sources:["/Users/zxf/code/motooling/mt-app/webs-mtapp/mtApp/mt/www_dev/src/views/production/MaterialRequisition/matList.vue"],names:[],mappings:";AACA;EACE,kBAAkB;MACd,cAAc;CACnB;AACD;IACI,mBAAmB;QACf,eAAe;IACnB,mBAAmB;CACtB;AACD;EACE,YAAY;EACZ,eAAe;EACf,WAAW;EACX,mBAAmB;EACnB,kBAAkB;CACnB",file:"matList.vue",sourcesContent:["\n.total[data-v-a55ca0ec] {\n  -ms-flex: 0 0 80%;\n      flex: 0 0 80%;\n}\n.total span[data-v-a55ca0ec] {\n    -ms-flex: 1 0 auto;\n        flex: 1 0 auto;\n    text-align: center;\n}\n.icon-saoyisao[data-v-a55ca0ec] {\n  float: left;\n  display: block;\n  width: 15%;\n  text-align: center;\n  line-height: 34px;\n}\n"],sourceRoot:""}])},825:function(t,a,n){var e=n(686);"string"==typeof e&&(e=[[t.i,e,""]]),e.locals&&(t.exports=e.locals);n(226)("9e4d3bdc",e,!0)},973:function(t,a){t.exports={render:function(){var t=this,a=t.$createElement,n=t._self._c||a;return n("div",{directives:[{name:"nav",rawName:"v-nav",value:{hideNavbar:!0},expression:"{hideNavbar:true}"}],staticClass:"mw-page page storage"},[n("div",{staticClass:"mw-page-header"},[n("i",{staticClass:"left icon ion-ios-arrow-back",on:{click:function(a){t.$router.go(-1)}}}),t._v(" "),n("span",[t._v("物料清单")]),t._v(" "),n("i",{staticClass:"right"})]),t._v(" "),n("div",{staticClass:"mw-page-content has-tab"},[n("div",{directives:[{name:"show",rawName:"v-show",value:1*t.type!=1,expression:"type*1!==1"}],staticStyle:{height:"50px"}},[n("div",{staticStyle:{width:"100%",height:"100%",padding:"10px"}},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.matSearch,expression:"matSearch"}],staticStyle:{float:"left",width:"85%","border-radius":"5px",padding:"0 5px","box-sizing":"border-box"},attrs:{type:"search",placeholder:"请输入物料编码"},domProps:{value:t.matSearch},on:{input:function(a){a.target.composing||(t.matSearch=a.target.value)}}}),t._v(" "),n("i",{staticClass:"iconfont icon-saoyisao"})])]),t._v(" "),n("div",{staticStyle:{flex:"1",position:"relative"}},[n("div",{staticClass:"hairline-top"}),t._v(" "),t._l(t.matList,function(a){return n("item",[n("div",{staticStyle:{display:"flex"}},[n("div",{staticClass:"matBill-content",staticStyle:{width:"80%"}},[n("p",{staticClass:"title"},[t._v("物料名称: "+t._s(a.mat_desc))]),t._v(" "),n("p",{staticClass:"title"},[t._v("物料编码: "+t._s(a.mat_no))]),t._v(" "),n("p",{staticClass:"title"},[t._v("规格型号: "+t._s(a.mat_model))]),t._v(" "),n("span",[t._v("所在仓库: "+t._s(a.store_house_name))]),t._v("  \n              "),1*t.type==1?n("span",[t._v("库存量: "+t._s(a.total_stock_qty))]):n("span",[t._v("库存量: "+t._s(a.stock_qty))]),t._v(" "),1*t.type==1?n("p",{staticClass:"title"},[t._v("需求量: "+t._s(a.undeal_qty))]):t._e()]),t._v(" "),a.quantity>0?n("div",{staticClass:"edit-zone",staticStyle:{width:"25%"}},[n("span",{on:{click:function(n){t.minCount(a)}}},[t._v("-")]),t._v("  \n                "),n("input",{directives:[{name:"model",rawName:"v-model",value:a.quantity,expression:"item.quantity"}],attrs:{type:"number"},domProps:{value:a.quantity},on:{change:function(n){t.countChange(a)},input:function(n){n.target.composing||t.$set(a,"quantity",n.target.value)}}}),t._v("\n                  "),n("span",{on:{click:function(n){t.addCount(a)}}},[t._v("+")])]):n("div",{staticClass:"edit-zone"},[n("span",{on:{click:function(n){t.addCount(a)}}},[t._v("+")])])])])})],2)]),t._v(" "),n("div",{staticClass:"mw-page-footer"},[n("div",{staticClass:"btns"},[n("div",{staticClass:"total"},[n("div",{staticStyle:{display:"flex"}},[n("span",[t._v("物料种类:"+t._s(this.chosenMats.length))]),t._v(" "),n("span",{staticStyle:{padding:"0 15px"}},[t._v(t._s(t.totalCount))])])]),t._v(" "),n("div",{staticClass:"btn",staticStyle:{"background-color":"#416eb6",color:"white",padding:"15px 0"},on:{click:t.ok}},[t._v("\n            确定\n        ")])])])])},staticRenderFns:[]}}});
//# sourceMappingURL=113.cc7d5c6cd565fc9245b1.js.map