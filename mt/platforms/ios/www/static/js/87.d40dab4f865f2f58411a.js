webpackJsonp([87],{320:function(e,t,n){n(673);var i=n(0)(n(477),n(783),"data-v-a3e8f888",null);e.exports=i.exports},477:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),o=n(50),a=n(85),s=n(32),c=(n.n(s),n(49)),l=n.n(c);t.default={name:"bindWX",components:{MwInput:l.a},data:function(){return{username:"",password:"",email:"",phone:"",login_type:"phone_with_code",checkCode:"",isSentCode:!1,downCount:60,interval:0,zone:{zh:"中国",code:"+86",en:"China"},wechat:{}}},created:function(){i.a.get("zoneCode")&&(this.zone=i.a.get("zoneCode")),this.wechat=this.$route.query.wechat},destory:function(){clearInterval(this.interval)},methods:{sendCode:function(){var e=this,t=this;this.checkCode="";var i={country_code:t.zone.code.substr(1),mobile:this.username,type:1};n.i(o.d)(i).then(function(n){t.isSentCode=!0,$toast.show("验证码已发送"),e.interval=setInterval(function(){t.downCount>0?t.downCount--:(clearInterval(this.interval),t.downCount=60,t.isSentCode=!1)},1e3)}).catch(function(e){$toast.show(e.description)})},noBindWX:function(){this.wechat.identity_type="wechat",this.bindWechat(0)},selectCompany:function(e){console.log(e)},changeZoneCode:function(){$router.forward("/zoneCode")},checkPhoneIsExist:function(){var e=this;if(!this.username||""===this.username||0===this.username.trim().length)return void $toast.show("手机号不能为空，请检查",1e3);if(!this.validPhone())return void $toast.show("手机号格式有误，请检查");var t={identity_type:"mobile",user:this.username};n.i(o.b)(t).then(function(t){e.validPhone("sendCode")}).catch(function(t){$toast.show(e.username+"尚未注册")})},changeType:function(e){this.login_type=e,this.username="",this.email="",this.password="",this.checkCode="",clearInterval(this.interval),this.downCount=60,this.isSentCode=!1},checkUser:function(){var e=this;if("email"===this.login_type){if(!e.email||""===e.email||0===e.email.trim().length)return void $toast.show(("email"===e.login_type?"邮箱":"手机号")+"不能为空，请检查",1e3)}else if(!e.username||""===e.username||0===e.username.trim().length)return void $toast.show(("email"===e.login_type?"邮箱":"手机号")+"不能为空，请检查",1e3);if("phone_with_code"===e.login_type&&!this.validPhone())return void $toast.show("手机号有误，请检查");if(!("phone_with_pwd"!==e.login_type||e.password&&0!==e.password.trim().length&&n.i(a.c)(e.password)))return void $toast.show("密码有误，请检查",1e3);if("phone_with_code"===e.login_type&&0===e.checkCode.trim().length)return void $toast.show("验证码不能为空",1e3);if("phone_with_code"===e.login_type&&!n.i(a.d)(this.checkCode))return void $toast.show("验证码有误，请检查",1e3);if("email"===e.login_type){if(!n.i(a.b)(e.email))return void $toast.show("邮箱格式有误，请检查",1e3);if(!e.password||""===e.password.trim()||0===e.password.trim().length||!n.i(a.c)(e.password))return void $toast.show("密码有误，请检查",1e3);e.submitLogin()}else this.validPhone("login")},submitLogin:function(){var e=this,t={user:"email"===e.login_type?e.email:e.username,identity_type:"email"===e.login_type?"email":"mobile"};"phone_with_code"===e.login_type?t.vericode=e.checkCode:t.password=e.password,e.$store.dispatch("Login",t).then(function(t){e.bindWechat(1)}).catch(function(e){$toast.show(e.description,1e3)})},validPhone:function(e){var t=this;if(!t.username||""===t.username)return void $toast.show(("email"===t.login_type?"邮箱":"手机号")+"不能为空，请检查",1e3);var i=n.i(a.a)(t.username);if(!i)return $toast.show("手机号不正确，请检查",1e3),i;if("login"===e)i&&this.submitLogin();else{if("sendCode"!==e)return i;i&&t.sendCode()}},bindWechat:function(e){var t=this.wechat,a=this;t.is_bind=e,n.i(o.g)(t).then(function(t){e||a.$store.dispatch("setTokenAndUid",{uid:t.uid,token:t.token}),a.$store.dispatch("GetInfo").then(function(e){console.log(e);var t=e.company;console.log("company"+t),t&&t.length>0?1===t.length?(a.$store.dispatch("setCompany",t[0]),$router.forward("/home")):(i.a.set("companys",t),$router.forward("/chooseCompany")):(console.log("company is null"),a.$store.dispatch("setCompany",""),$router.forward("/home"))}).catch(function(e){$toast.show("网络异常，请稍后重试!",1e3)})}).catch(function(e){$toast.show("绑定微信失败")})}}}},572:function(e,t,n){t=e.exports=n(220)(),t.push([e.i,"\n.width[data-v-a3e8f888] {\n  width: 70%;\n  margin: 0 auto;\n  text-align: center;\n}\n.checkCode[data-v-a3e8f888] {\n  width: 50%;\n  padding: 0;\n  float: left;\n}\n.login_type[data-v-a3e8f888] {\n  color: #416eb6;\n  text-align: left;\n  padding: 10px 2px;\n  display: inline;\n  float: left;\n}\n.right[data-v-a3e8f888] {\n  text-align: right;\n  float: right;\n}\n.getCode[data-v-a3e8f888] {\n  width: 50%;\n  float: right;\n  background-color: white;\n  color: #416eb6;\n  line-height: 50px;\n  height: 50px;\n  text-align: center;\n  box-shadow: none;\n  font-size: 14px;\n}\n.zoneCode[data-v-a3e8f888] {\n  height: 49px;\n  line-height: 49px;\n  text-align: left;\n}\n.zoneCode span[data-v-a3e8f888] {\n    padding-left: 15px;\n    color: #9c9c9c;\n}\n.zoneCode .code[data-v-a3e8f888] {\n    color: black;\n}\n","",{version:3,sources:["E:/weibosi/webs-mt/mt/www_dev/src/views/user/login/bindWX.vue"],names:[],mappings:";AACA;EACE,WAAW;EACX,eAAe;EACf,mBAAmB;CACpB;AACD;EACE,WAAW;EACX,WAAW;EACX,YAAY;CACb;AACD;EACE,eAAe;EACf,iBAAiB;EACjB,kBAAkB;EAClB,gBAAgB;EAChB,YAAY;CACb;AACD;EACE,kBAAkB;EAClB,aAAa;CACd;AACD;EACE,WAAW;EACX,aAAa;EACb,wBAAwB;EACxB,eAAe;EACf,kBAAkB;EAClB,aAAa;EACb,mBAAmB;EACnB,iBAAiB;EACjB,gBAAgB;CACjB;AACD;EACE,aAAa;EACb,kBAAkB;EAClB,iBAAiB;CAClB;AACD;IACI,mBAAmB;IACnB,eAAe;CAClB;AACD;IACI,aAAa;CAChB",file:"bindWX.vue",sourcesContent:["\n.width[data-v-a3e8f888] {\n  width: 70%;\n  margin: 0 auto;\n  text-align: center;\n}\n.checkCode[data-v-a3e8f888] {\n  width: 50%;\n  padding: 0;\n  float: left;\n}\n.login_type[data-v-a3e8f888] {\n  color: #416eb6;\n  text-align: left;\n  padding: 10px 2px;\n  display: inline;\n  float: left;\n}\n.right[data-v-a3e8f888] {\n  text-align: right;\n  float: right;\n}\n.getCode[data-v-a3e8f888] {\n  width: 50%;\n  float: right;\n  background-color: white;\n  color: #416eb6;\n  line-height: 50px;\n  height: 50px;\n  text-align: center;\n  box-shadow: none;\n  font-size: 14px;\n}\n.zoneCode[data-v-a3e8f888] {\n  height: 49px;\n  line-height: 49px;\n  text-align: left;\n}\n.zoneCode span[data-v-a3e8f888] {\n    padding-left: 15px;\n    color: #9c9c9c;\n}\n.zoneCode .code[data-v-a3e8f888] {\n    color: black;\n}\n"],sourceRoot:""}])},673:function(e,t,n){var i=n(572);"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);n(221)("40762c44",i,!0)},783:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{directives:[{name:"nav",rawName:"v-nav",value:{hideNavbar:!0},expression:"{hideNavbar:true}"}],staticClass:"mw-page page"},[n("div",{staticClass:"mw-page-header"},[n("i",{staticClass:"left icon ion-ios-arrow-back",on:{click:function(t){e.$router.go(-1)}}}),e._v(" "),n("span",[e._v("绑定账号")]),e._v(" "),n("i")]),e._v(" "),n("div",{staticClass:"mw-page-content"},[n("div",{staticStyle:{height:"100%"}},[e._m(0,!1,!1),e._v(" "),"email"!==e.login_type?n("div",{staticStyle:{width:"70%",margin:"0 auto"}},[n("div",{staticStyle:{display:"inline"}},[n("div",{staticClass:"zoneCode",on:{click:e.changeZoneCode}},[n("span",[e._v(e._s(e.$t("region")))]),e._v(" "),n("span",{staticClass:"code"},[e._v(e._s(e.zone.zh)+" ("+e._s(e.zone.code)+")")])])]),e._v(" "),n("mw-input",{attrs:{placeholder:e.$t("enter-phone"),inputType:"tel"},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}}),e._v(" "),n("div",{staticStyle:{"margin-top":"5px"}},[n("mw-input",{staticStyle:{width:"50%",float:"left"},attrs:{placeholder:e.$t("enter-sms-code"),inputType:"tel"},model:{value:e.checkCode,callback:function(t){e.checkCode=t},expression:"checkCode"}}),e._v(" "),e.isSentCode?n("div",{staticClass:"getCode",staticStyle:{color:"#bbbbbb"}},[e._v("\n            "+e._s(e.$t("get-sms-code-again"))+"("+e._s(e.downCount)+")\n          ")]):n("div",{staticClass:"getCode",on:{click:e.checkPhoneIsExist}},[e._v(e._s(e.$t("get-sms-code")))])],1)],1):n("div",{staticStyle:{width:"70%",margin:"0 auto"}},[n("div",{staticStyle:{height:"49px"}}),e._v(" "),n("mw-input",{attrs:{placeholder:e.$t("enter-email"),inputType:"email"},model:{value:e.email,callback:function(t){e.email=t},expression:"email"}}),e._v(" "),n("div",{staticStyle:{"margin-top":"5px"}},[n("mw-input",{attrs:{placeholder:e.$t("enter-password"),inputType:"password"},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}})],1)],1),e._v(" "),n("div",{staticClass:"width"},["email"===e.login_type?n("p",{staticClass:"login_type",on:{click:function(t){e.changeType("phone_with_code")}}},[e._v(e._s(e.$t("login-via-phone")))]):n("p",{staticClass:"login_type",on:{click:function(t){e.changeType("email")}}},[e._v(e._s(e.$t("login-via-email")))]),e._v(" "),n("md-button",{staticClass:"button button-positive button-block",staticStyle:{"background-color":"#4161b6"},nativeOn:{click:function(t){e.checkUser(t)}}},[e._v("绑定")]),e._v(" "),n("p",{staticStyle:{"margin-top":"15%",color:"#416eb6"},on:{click:e.noBindWX}},[e._v(" 不绑定，直接用微信账号登录")])],1)])])])},staticRenderFns:[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"logo",staticStyle:{height:"20%","text-align":"center","padding-top":"8%",width:"60%",margin:"0 auto",color:"#416eb6"}},[n("p",[e._v("如果您之前注册过MoTooling")]),e._v(" "),n("p",[e._v("可以将微信绑定至您的账号")])])}]}}});
//# sourceMappingURL=87.d40dab4f865f2f58411a.js.map