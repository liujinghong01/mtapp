webpackJsonp([117],{243:function(e,t,i){i(714);var n=i(0)(i(441),i(857),"data-v-056fe1c4",null);e.exports=n.exports},388:function(e,t,i){"use strict";function n(e){return i.i(x.a)({url:"/api/pm/pg/detail",method:"post",data:e})}function a(e){return i.i(x.a)({url:"/api/pm/pg/list",method:"post",data:e})}function o(e){return i.i(x.a)({url:"/api/pm/pg_device/list",method:"post",data:e})}function p(e){return i.i(x.a)({url:"/api/pm/device_maintain_curr/query",method:"post",data:e})}function s(e){return i.i(x.a)({url:"/api/pm/pg_device/maintain_record",method:"post",data:e})}function d(e){return i.i(x.a)({url:"/api/pm/pg_device_check_allocate/list",method:"post",data:e})}function c(e){return i.i(x.a)({url:"/api/pm/pg_device/check_allocate_delete",method:"post",data:e})}function r(e){return i.i(x.a)({url:"/api/pm/pg_device_check/list",method:"post",data:e})}function m(e){return i.i(x.a)({url:"/api/pm/pg_device/detail",method:"post",data:e})}function u(e){return i.i(x.a)({url:"/api/pm/pg/delete",method:"post",data:e})}function l(e){return i.i(x.a)({url:"/api/pm/pg/modify",method:"post",data:e})}function h(e){return i.i(x.a)({url:"/api/pm/pg_device/delete",method:"post",data:e})}function _(e){return i.i(x.a)({url:"/api/pm/pg_device/modify",method:"post",data:e})}function f(e){return i.i(x.a)({url:"/api/pm/device_maintain_bill/save",method:"post",data:e})}function v(e){return i.i(x.a)({url:"/api/pm/device_maintain/start",method:"post",data:e})}function g(e){return i.i(x.a)({url:"/api/pm/pg_device/check",method:"post",data:e})}function w(e){return i.i(x.a)({url:"/api/pm/pg_device/check_allocate_modify",method:"post",data:e})}function C(e){return i.i(x.a)({url:"/api/pm/pg_device_check_allocate/detail",method:"post",data:e})}function b(e){return i.i(x.a)({url:"/api/company/getAllDeptMember",method:"post",data:e})}function A(e){return i.i(x.a)({url:"/api/pm/pg_member/delete",method:"post",data:e})}function D(e){return i.i(x.a)({url:"/api/pm/pg_member/modify",method:"post",data:e})}function y(e){return i.i(x.a)({url:"api/company/get-all-members",method:"post",data:e})}t.o=n,t.a=a,t.n=o,t.e=p,t.g=s,t.j=d,t.k=c,t.d=r,t.b=m,t.v=u,t.t=l,t.s=h,t.i=_,t.f=f,t.h=v,t.c=g,t.m=w,t.l=C,t.u=b,t.r=A,t.q=D,t.p=y;var x=i(10)},441:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(6),a=i.n(n),o=i(5),p=i(20),s=i.n(p),d=i(79),c=i(388),r=i(84),m=i.n(r),u=i(82),l=i.n(u);t.default={name:"deptDetail",data:function(){return{dep_id:"",dep_name:"",dep_code:"",showPopup:!1,addDepFlag:!1,depList:[],members:[],newDepName:"",action:"check"}},components:{MwPrompt:l.a,invite:m.a,SwipeItem:s.a},computed:i.i(o.a)(["chosenCompany","userinfo"]),created:function(){},activated:function(){var e=this.$route.query;this.dep_id=e.dep_id,this.dep_name=e.dep_name,this.dep_code=e.dep_code,"Production_Dept"==this.dep_code&&this.getPgList(),this.getDepts()},methods:{delDept:function(e,t){var n=this,a={pg_info:{pg_id:e.pg_id}};i.i(c.v)(a).then(function(e){$toast.show("删除成功"),n.depList.splice(t,1)}).catch(function(e){$toast.show(e.description)})},addSubDep:function(){"Production_Dept"===this.dep_code?this.$router.forward({path:"/company/productionDeptSub",query:{parent_id:this.dep_id,action:"new",dep_name:"新建子部门",upperDepName:this.dep_name,dep_code:this.dep_code,parentId:this.dep_id}}):this.addDepFlag=!0},turnCheck:function(){this.action="check",this.addDepFlag=!1,this.showPopup=!1},getDepts:function(){var e=this,t=this;if(t.chosenCompany.company_id){var n={company_id:t.chosenCompany.company_id,dep_id:t.dep_id};i.i(d.h)(n).then(function(i){"Production_Dept"!==e.dep_code&&(t.depList=i.deps),t.members=i.memberInfos}).catch(function(e){$toast.show(e.description)})}},getPgList:function(){var e=this,t={page_size:100,query:{dep_id:this.dep_id}};i.i(c.a)(t).then(function(t){e.depList=t.pg_list}).catch(function(e){$toast.show(e.description)})},getAllDeptMember:function(){var e={query:{dep_code:this.dep_code}};i.i(c.u)(e).then(function(e){}).catch(function(e){$toast.show(e.description)})},showEditAction:function(){var e=this,t=this,i=new Object;i["批量移动员工"]=function(){if(0===t.members.length)return void $toast.show("当前部门无可移动员工");t.$router.forward({path:"/company/batchSelect",query:{members:a()(t.members),type:"move",dep_id:e.dep_id}})},i["批量删除员工"]=function(){if(0===t.members.length)return void $toast.show("当前部门无可删除员工");t.$router.forward({path:"/company/batchSelect",query:{members:a()(t.members),type:"del",dep_id:e.dep_id}})},$actionSheet.show({buttons:i,title:"批量操作",cancelText:t.$t("cancel")})},showInput:function(){this.addDepFlag||(this.addDepFlag=!this.addDepFlag)},hideInput:function(){this.addDepFlag=!1,this.newDepName=""},addNewDep:function(){var e=this;if(""===this.newDepName.trim())return void $toast.show("部门名称不能为空");var t={company_id:e.chosenCompany.company_id,dep_name:e.newDepName,upper_id:e.dep_id?e.dep_id:"undefined"};i.i(d.i)(t).then(function(t){e.hideInput(),e.getDepts()}).catch(function(e){$toast.show(e.description)})},goDepDetail:function(e){"Production_Dept"===this.dep_code?this.$router.forward({path:"/company/productionDeptSub",query:{dep_id:e.pg_id,dep_name:e.pg_name,parent_id:this.dep_id,upperDepName:this.dep_name,action:"check"}}):this.$router.forward({path:"/company/subDeptDetail",query:{dep_id:e.dep_id,dep_name:e.dep_name,upperDepName:this.dep_name}})}}}},575:function(e,t,i){t=e.exports=i(225)(),t.push([e.i,"\n.label[data-v-056fe1c4] {\n  transform: scale(0.8, 0.8);\n  -webkit-transform: scale(0.8, 0.8);\n  /* Chrome, Safari, Opera */\n  -moz-transform: scale(0.8, 0.8);\n  color: #416eb6;\n  font-size: 12px;\n  padding-left: 5px;\n}\n.item-img[data-v-056fe1c4] {\n  width: 30px;\n  height: 30px;\n  float: left;\n}\n.text-btn[data-v-056fe1c4] {\n  border: 1px solid #4a90e2;\n  padding: 3px;\n  border-radius: 2px;\n  margin-right: 10px;\n}\n","",{version:3,sources:["/Users/zxf/code/motooling/mt-app/webs-mtapp/mtApp/mt/www_dev/src/views/company/deptDetail.vue"],names:[],mappings:";AACA;EACE,2BAA2B;EAC3B,mCAAmC;EACnC,2BAA2B;EAC3B,gCAAgC;EAChC,eAAe;EACf,gBAAgB;EAChB,kBAAkB;CACnB;AACD;EACE,YAAY;EACZ,aAAa;EACb,YAAY;CACb;AACD;EACE,0BAA0B;EAC1B,aAAa;EACb,mBAAmB;EACnB,mBAAmB;CACpB",file:"deptDetail.vue",sourcesContent:["\n.label[data-v-056fe1c4] {\n  transform: scale(0.8, 0.8);\n  -webkit-transform: scale(0.8, 0.8);\n  /* Chrome, Safari, Opera */\n  -moz-transform: scale(0.8, 0.8);\n  color: #416eb6;\n  font-size: 12px;\n  padding-left: 5px;\n}\n.item-img[data-v-056fe1c4] {\n  width: 30px;\n  height: 30px;\n  float: left;\n}\n.text-btn[data-v-056fe1c4] {\n  border: 1px solid #4a90e2;\n  padding: 3px;\n  border-radius: 2px;\n  margin-right: 10px;\n}\n"],sourceRoot:""}])},714:function(e,t,i){var n=i(575);"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);i(226)("267187b7",n,!0)},857:function(e,t,i){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{directives:[{name:"nav",rawName:"v-nav",value:{hideNavbar:!0},expression:"{hideNavbar:true}"}],staticClass:"mw-page page"},[n("div",{staticClass:"mw-page-header"},[n("i",{staticClass:"left icon ion-ios-arrow-back",on:{click:function(t){e.$router.go(-1)}}}),e._v(" "),n("span",[e._v(e._s(e.dep_name))]),e._v(" "),"check"===e.action?n("i",{staticClass:"right",on:{click:function(t){e.action="edit"}}},[e._v("管理")]):e._e(),e._v(" "),"edit"===e.action?n("i",{staticClass:"right",on:{click:function(t){e.action="check"}}},[e._v("取消")]):e._e()]),e._v(" "),n("div",{staticClass:"mw-page-content"},[n("list",[n("item",[n("span",{staticStyle:{opacity:".6"}},[e._v(e._s(e.chosenCompany.company_name))]),e._v(" "),n("i",{staticClass:"icon ion-ios-arrow-right"}),e._v(" "+e._s(e.dep_name)+"\n            ")])],1),e._v(" "),"生产部"===e.dep_name?n("list",e._l(e.depList,function(t,i){return n("swipe-item",{staticStyle:{padding:"0px",margin:"0px"},attrs:{obj:t,canSwipe:!0,swipeItemText:"删除"},on:{SwipeItemClick:function(n){e.delDept(t,i)}},nativeOn:{click:function(i){e.goDepDetail(t)}}},[n("item",{staticClass:"item-icon-right",staticStyle:{margin:"0px"}},[e._v("\n              "+e._s(t.pg_name)+"\n              "),n("i",{staticClass:"icon ion-ios-arrow-right",staticStyle:{color:"#DDD"}})])],1)})):n("list",e._l(e.depList,function(t){return n("item",{key:"item.dep_id",staticClass:"item-icon-right",nativeOn:{click:function(i){e.goDepDetail(t)}}},[e._v("\n            "+e._s(t.dep_name)+"\n            "),e._v(" "),n("i",{staticClass:"icon ion-ios-arrow-right",staticStyle:{color:"#DDD"}})])})),e._v(" "),n("list",[n("div",{staticClass:"item item-divider-ios"},[e._v("\n            成员\n          ")]),e._v(" "),e._l(e.members,function(t){return n("item",{key:"item.members",staticClass:"item-icon-right item-contact",nativeOn:{click:function(i){e.$router.forward("/company/memberDetail/"+t.member_id)}}},[n("img",{staticClass:"item-img",attrs:{src:t.icon?t.icon:"static/images/company/contact2.png"}}),e._v(" "),n("span",{staticStyle:{"line-height":"30px","margin-left":"15px"}},[e._v(e._s(t.work_name))]),t.member_id===e.userinfo.uid?n("span",{staticClass:"label"},[e._v("我自己")]):e._e()])}),e._v(" "),n("item",{staticClass:"item-icon-right",nativeOn:{click:function(t){e.showPopup=!0}}},[n("img",{staticClass:"item-img",attrs:{src:i(81)}}),e._v(" "),n("span",{staticStyle:{"line-height":"30px","margin-left":"15px"}},[e._v("邀请同事加入")])])],2),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.showPopup,expression:"showPopup"}]},[n("invite",{attrs:{dep_id:e.dep_id,dep_name:e.dep_name,type:"2"},on:{hideInvite:function(t){e.showPopup=!1}}})],1)],1),e._v(" "),n("mw-prompt",{attrs:{show:e.addDepFlag,okFunction:e.addNewDep,placeholder:"请输入部门名称"},on:{hidePop:function(t){e.addDepFlag=!1}},model:{value:e.newDepName,callback:function(t){e.newDepName=t},expression:"newDepName"}}),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:"edit"===e.action,expression:"action==='edit'"}],staticClass:"mw-page-footer"},[n("div",{staticClass:"btns"},[n("div",{staticClass:"btn",on:{click:e.addSubDep}},[e._v("添加子部门")]),e._v(" "),n("div",{staticClass:"divider"}),e._v(" "),n("div",{staticClass:"btn",on:{click:function(t){e.$router.forward("/company/deptSetting/"+e.dep_id)}}},[e._v("部门设置")])])])],1)},staticRenderFns:[]}}});
//# sourceMappingURL=117.ec79fe8c7684feb32a7d.js.map